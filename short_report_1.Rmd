---
title: "Short Report 1"
author: "Kunwu Lyu"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(GGally)
```

## Data Wrangling
```{r}
#first spotify data, with crossover variable
#BE SURE TO DELETE THE LINE BREAK BEFORE RUNNING THIS
spotify_data_crossover <- read.csv(file = "https://www.math.carleton.edu/ckelling/regression/report_cross_spotify_data.csv")


#second spotify dataset- all data, crossover labelled or not
#BE SURE TO DELETE THE LINE BREAK BEFORE RUNNING THIS
full_musc_data <- read.csv(file = "https://www.math.carleton.edu/ckelling/regression/report_nocross_spotify_data.csv") %>% 
  mutate(mode = as.factor(mode),
         key = as.factor(key))


#subset to just a few artists
# spotify_data_subset <- spotify_data_crossover %>%
#   filter(artist_name %in% c(artist, names, here))

glimpse(full_musc_data)

```



## EDA
```{r}
affective_musc_lm <- lm(valence ~ danceability*energy, data = full_musc_data)
summary(affective_musc_lm)

ggpairs(full_musc_data, columns = c("mode", "tempo", "valence"))

ggpairs(full_musc_data, columns = c("danceability", "energy", "valence"))

live_musc_lm <- lm(liveness ~ loudness+tempo+instrumentalness+valence, data = full_musc_data)
summary(live_musc_lm)

ggpairs(full_musc_data, columns = c("loudness", "tempo", "instrumentalness", "valence", "liveness"))

```


```{r}
# add something here
```

